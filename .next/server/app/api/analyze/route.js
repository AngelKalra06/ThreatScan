"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/analyze/route";
exports.ids = ["app/api/analyze/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5Chp%5CDocuments%5CThreatScan%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Chp%5CDocuments%5CThreatScan&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5Chp%5CDocuments%5CThreatScan%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Chp%5CDocuments%5CThreatScan&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_hp_Documents_ThreatScan_app_api_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/analyze/route.ts */ \"(rsc)/./app/api/analyze/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/analyze/route\",\n        pathname: \"/api/analyze\",\n        filename: \"route\",\n        bundlePath: \"app/api/analyze/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\hp\\\\Documents\\\\ThreatScan\\\\app\\\\api\\\\analyze\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_hp_Documents_ThreatScan_app_api_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/analyze/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhbmFseXplJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhbmFseXplJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYW5hbHl6ZSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNocCU1Q0RvY3VtZW50cyU1Q1RocmVhdFNjYW4lNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q2hwJTVDRG9jdW1lbnRzJTVDVGhyZWF0U2NhbiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNpQjtBQUM5RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL2dyZWVuc2hpZWxkLW1hbHdhcmUtZGV0ZWN0b3IvPzBlNzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcaHBcXFxcRG9jdW1lbnRzXFxcXFRocmVhdFNjYW5cXFxcYXBwXFxcXGFwaVxcXFxhbmFseXplXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hbmFseXplL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYW5hbHl6ZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYW5hbHl6ZS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXGhwXFxcXERvY3VtZW50c1xcXFxUaHJlYXRTY2FuXFxcXGFwcFxcXFxhcGlcXFxcYW5hbHl6ZVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hbmFseXplL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5Chp%5CDocuments%5CThreatScan%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Chp%5CDocuments%5CThreatScan&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/analyze/route.ts":
/*!**********************************!*\
  !*** ./app/api/analyze/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// Move calculateEntropy outside POST\nfunction calculateEntropy(buf) {\n    const freq = new Array(256).fill(0);\n    for(let i = 0; i < buf.length; i++)freq[buf[i]]++;\n    let entropy = 0;\n    for(let i = 0; i < 256; i++){\n        if (freq[i] === 0) continue;\n        const p = freq[i] / buf.length;\n        entropy -= p * Math.log2(p);\n    }\n    return entropy;\n}\nasync function POST(request) {\n    try {\n        // Set a higher limit for this specific route\n        const formData = await request.formData();\n        const file = formData.get(\"file\");\n        if (!file) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"No file provided\"\n            }, {\n                status: 400\n            });\n        }\n        // Check file size limit (100MB)\n        const maxSize = 100 * 1024 * 1024;\n        if (file.size > maxSize) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"File too large. Maximum size is 100MB.\"\n            }, {\n                status: 413\n            });\n        }\n        // Convert file to buffer for analysis\n        let bytes;\n        let buffer;\n        try {\n            bytes = await file.arrayBuffer();\n            buffer = Buffer.from(bytes);\n        } catch (error) {\n            console.error(\"Error reading file:\", error);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Error reading file. File may be corrupted or too large.\"\n            }, {\n                status: 500\n            });\n        }\n        // Generate SHA256 hash\n        const hash = crypto__WEBPACK_IMPORTED_MODULE_1___default().createHash(\"sha256\").update(buffer).digest(\"hex\");\n        // Generate MD5 hash\n        const md5 = crypto__WEBPACK_IMPORTED_MODULE_1___default().createHash(\"md5\").update(buffer).digest(\"hex\");\n        // Get MIME type if available\n        let mimeType = file.type || \"unknown\";\n        let fileType = \"unknown\";\n        const extMatch = file.name.match(/\\.([a-zA-Z0-9]+)$/);\n        if (extMatch) {\n            fileType = extMatch[1].toLowerCase();\n        }\n        // Upload time\n        const uploadTime = new Date().toISOString();\n        // Heuristic analysis\n        const suspiciousIndicators = [];\n        const detectionRulesTriggered = [];\n        // Check if file is text-based or binary\n        const isTextFile = [\n            \"txt\",\n            \"log\",\n            \"md\",\n            \"json\",\n            \"xml\",\n            \"html\",\n            \"css\",\n            \"js\",\n            \"py\",\n            \"java\",\n            \"c\",\n            \"cpp\",\n            \"h\",\n            \"bat\",\n            \"ps1\",\n            \"sh\"\n        ].includes(fileType);\n        const isDocumentFile = [\n            \"doc\",\n            \"docx\",\n            \"pdf\",\n            \"rtf\"\n        ].includes(fileType);\n        // Only perform string analysis on text-based files or if we can safely convert to string\n        if (isTextFile || isDocumentFile) {\n            try {\n                const fileContent = buffer.toString(\"utf8\");\n                // Suspicious strings\n                const suspiciousStrings = [\n                    \"powershell\",\n                    \"cmd.exe\",\n                    \"base64\",\n                    \"eval\",\n                    \"exec\",\n                    \"system\",\n                    \"shell\",\n                    \"download\",\n                    \"http://\",\n                    \"ftp://\",\n                    \"bitcoin\",\n                    \"crypto\",\n                    \"taskkill\",\n                    \"system32\",\n                    \"admin\",\n                    \"reverse shell\",\n                    \"nc.exe\",\n                    \"/bin/sh\",\n                    \"bash -i\",\n                    \"whoami\",\n                    \"net user\",\n                    \"reg add\",\n                    \"reg delete\",\n                    \"schtasks\",\n                    \"at.exe\",\n                    \"sc.exe\",\n                    \"wmic\",\n                    \"vssadmin\",\n                    \"bypass\",\n                    \"encodedcommand\",\n                    \"-enc\",\n                    \"Invoke-Expression\",\n                    \"Invoke-WebRequest\"\n                ];\n                suspiciousStrings.forEach((str)=>{\n                    if (fileContent.toLowerCase().includes(str)) {\n                        suspiciousIndicators.push(`Contains suspicious string: ${str}`);\n                        detectionRulesTriggered.push(\"SUSPICIOUS_STRING_DETECTED\");\n                    }\n                });\n                // System folder/admin tool usage\n                if (fileContent.toLowerCase().includes(\"system32\")) {\n                    suspiciousIndicators.push(\"Access to system32 folder\");\n                    detectionRulesTriggered.push(\"SYSTEM_FOLDER_ACCESS\");\n                }\n                if (fileContent.toLowerCase().includes(\"taskkill\")) {\n                    suspiciousIndicators.push(\"Uses 'taskkill' command\");\n                    detectionRulesTriggered.push(\"ADMIN_TOOL_USAGE\");\n                }\n            } catch (error) {\n                console.warn(\"Could not analyze file content as text:\", error);\n            // Continue with other analysis methods\n            }\n        }\n        // Calculate entropy safely\n        let entropy = 0;\n        try {\n            entropy = calculateEntropy(buffer);\n            if (entropy > 7.5) {\n                suspiciousIndicators.push(\"High file entropy (possible obfuscation or packed binary)\");\n                detectionRulesTriggered.push(\"HIGH_ENTROPY_DETECTED\");\n            }\n        } catch (error) {\n            console.warn(\"Could not calculate entropy:\", error);\n        // Continue without entropy analysis\n        }\n        // Threat scoring\n        let threatScore = 0;\n        if ([\n            \"exe\",\n            \"dll\",\n            \"scr\",\n            \"bat\",\n            \"cmd\",\n            \"pif\",\n            \"com\"\n        ].includes(fileType)) threatScore += 30;\n        if (file.size < 1024) threatScore += 10;\n        if (file.size > 50 * 1024 * 1024) threatScore += 10;\n        threatScore += suspiciousIndicators.length * 10;\n        if (entropy > 7.5) threatScore += 10;\n        if (detectionRulesTriggered.length > 0) threatScore += detectionRulesTriggered.length * 5;\n        if (threatScore > 100) threatScore = 100;\n        let threatLevel = \"clean\";\n        if (threatScore >= 70) threatLevel = \"malicious\";\n        else if (threatScore >= 30) threatLevel = \"suspicious\";\n        // Recommendation\n        let recommendation = \"No obvious threats detected in the file. However, proceed with caution if you do not trust the source.\";\n        if (threatLevel === \"malicious\") recommendation = \"Do not run this file. It is likely malware.\";\n        else if (threatLevel === \"suspicious\") recommendation = \"File may be suspicious. Analyze further before running.\";\n        // Optional: External report link (mock)\n        let externalReportLink = undefined;\n        if (threatScore > 50) {\n            externalReportLink = `https://www.virustotal.com/gui/file/${hash}`;\n        }\n        // Build response\n        const response = {\n            file_name: file.name,\n            sha256: hash,\n            md5: md5,\n            file_size: `${(file.size / 1024).toFixed(2)} KB`,\n            file_type: fileType,\n            mime_type: mimeType,\n            upload_time: uploadTime,\n            threat_score: threatScore,\n            threat_level: threatLevel,\n            suspicious_indicators: suspiciousIndicators,\n            detection_rules_triggered: detectionRulesTriggered,\n            recommendation,\n            external_report_link: externalReportLink\n        };\n        // Store the report for later retrieval\n        try {\n            const reportData = {\n                ...response,\n                scanTime: uploadTime,\n                id: hash\n            };\n            const { storeReport } = await __webpack_require__.e(/*! import() */ \"_rsc_app_api_report_utils_ts\").then(__webpack_require__.bind(__webpack_require__, /*! ../report/utils */ \"(rsc)/./app/api/report/utils.ts\"));\n            storeReport(hash, reportData);\n        } catch (error) {\n            console.warn(\"Could not store report:\", error);\n        // Continue without storing report\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(response);\n    } catch (error) {\n        console.error(\"Analysis error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Analysis failed\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFDM0JhO1lBQ0FlLHNCQUFzQmQ7UUFDeEI7UUFFQSx1Q0FBdUM7UUFDdkMsSUFBSTtZQUNGLE1BQU1lLGFBQWE7Z0JBQ2pCLEdBQUdiLFFBQVE7Z0JBQ1hjLFVBQVVsQztnQkFDVm1DLElBQUkvQztZQUNOO1lBQ0EsTUFBTSxFQUFFZ0QsV0FBVyxFQUFFLEdBQUcsTUFBTSxtTEFBeUI7WUFDdkRBLFlBQVloRCxNQUFNNkM7UUFDcEIsRUFBRSxPQUFPdkQsT0FBTztZQUNkUyxRQUFRMkIsSUFBSSxDQUFDLDJCQUEyQnBDO1FBQ3hDLGtDQUFrQztRQUNwQztRQUVBLE9BQU9uQixrRkFBWUEsQ0FBQ2tCLElBQUksQ0FBQzJDO0lBQzNCLEVBQUUsT0FBTzFDLE9BQU87UUFDZFMsUUFBUVQsS0FBSyxDQUFDLG1CQUFtQkE7UUFDakMsT0FBT25CLGtGQUFZQSxDQUFDa0IsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBa0IsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDdkU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2dyZWVuc2hpZWxkLW1hbHdhcmUtZGV0ZWN0b3IvLi9hcHAvYXBpL2FuYWx5emUvcm91dGUudHM/NDZiYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0eXBlIE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIlxuaW1wb3J0IGNyeXB0byBmcm9tIFwiY3J5cHRvXCJcblxuLy8gTW92ZSBjYWxjdWxhdGVFbnRyb3B5IG91dHNpZGUgUE9TVFxuZnVuY3Rpb24gY2FsY3VsYXRlRW50cm9weShidWY6IEJ1ZmZlcikge1xuICBjb25zdCBmcmVxID0gbmV3IEFycmF5KDI1NikuZmlsbCgwKVxuICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1Zi5sZW5ndGg7IGkrKykgZnJlcVtidWZbaV1dKytcbiAgbGV0IGVudHJvcHkgPSAwXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyBpKyspIHtcbiAgICBpZiAoZnJlcVtpXSA9PT0gMCkgY29udGludWVcbiAgICBjb25zdCBwID0gZnJlcVtpXSAvIGJ1Zi5sZW5ndGhcbiAgICBlbnRyb3B5IC09IHAgKiBNYXRoLmxvZzIocClcbiAgfVxuICByZXR1cm4gZW50cm9weVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIFNldCBhIGhpZ2hlciBsaW1pdCBmb3IgdGhpcyBzcGVjaWZpYyByb3V0ZVxuICAgIGNvbnN0IGZvcm1EYXRhID0gYXdhaXQgcmVxdWVzdC5mb3JtRGF0YSgpXG4gICAgY29uc3QgZmlsZSA9IGZvcm1EYXRhLmdldChcImZpbGVcIikgYXMgRmlsZVxuXG4gICAgaWYgKCFmaWxlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJObyBmaWxlIHByb3ZpZGVkXCIgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgIH1cblxuICAgIC8vIENoZWNrIGZpbGUgc2l6ZSBsaW1pdCAoMTAwTUIpXG4gICAgY29uc3QgbWF4U2l6ZSA9IDEwMCAqIDEwMjQgKiAxMDI0XG4gICAgaWYgKGZpbGUuc2l6ZSA+IG1heFNpemUpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkZpbGUgdG9vIGxhcmdlLiBNYXhpbXVtIHNpemUgaXMgMTAwTUIuXCIgfSwgeyBzdGF0dXM6IDQxMyB9KVxuICAgIH1cblxuICAgIC8vIENvbnZlcnQgZmlsZSB0byBidWZmZXIgZm9yIGFuYWx5c2lzXG4gICAgbGV0IGJ5dGVzOiBBcnJheUJ1ZmZlclxuICAgIGxldCBidWZmZXI6IEJ1ZmZlclxuICAgIFxuICAgIHRyeSB7XG4gICAgICBieXRlcyA9IGF3YWl0IGZpbGUuYXJyYXlCdWZmZXIoKVxuICAgICAgYnVmZmVyID0gQnVmZmVyLmZyb20oYnl0ZXMpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZWFkaW5nIGZpbGU6XCIsIGVycm9yKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiRXJyb3IgcmVhZGluZyBmaWxlLiBGaWxlIG1heSBiZSBjb3JydXB0ZWQgb3IgdG9vIGxhcmdlLlwiIH0sIHsgc3RhdHVzOiA1MDAgfSlcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSBTSEEyNTYgaGFzaFxuICAgIGNvbnN0IGhhc2ggPSBjcnlwdG8uY3JlYXRlSGFzaChcInNoYTI1NlwiKS51cGRhdGUoYnVmZmVyKS5kaWdlc3QoXCJoZXhcIilcblxuICAgIC8vIEdlbmVyYXRlIE1ENSBoYXNoXG4gICAgY29uc3QgbWQ1ID0gY3J5cHRvLmNyZWF0ZUhhc2goXCJtZDVcIikudXBkYXRlKGJ1ZmZlcikuZGlnZXN0KFwiaGV4XCIpXG5cbiAgICAvLyBHZXQgTUlNRSB0eXBlIGlmIGF2YWlsYWJsZVxuICAgIGxldCBtaW1lVHlwZSA9IGZpbGUudHlwZSB8fCBcInVua25vd25cIlxuICAgIGxldCBmaWxlVHlwZSA9IFwidW5rbm93blwiXG4gICAgY29uc3QgZXh0TWF0Y2ggPSBmaWxlLm5hbWUubWF0Y2goL1xcLihbYS16QS1aMC05XSspJC8pXG4gICAgaWYgKGV4dE1hdGNoKSB7XG4gICAgICBmaWxlVHlwZSA9IGV4dE1hdGNoWzFdLnRvTG93ZXJDYXNlKClcbiAgICB9XG5cbiAgICAvLyBVcGxvYWQgdGltZVxuICAgIGNvbnN0IHVwbG9hZFRpbWUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcblxuICAgIC8vIEhldXJpc3RpYyBhbmFseXNpc1xuICAgIGNvbnN0IHN1c3BpY2lvdXNJbmRpY2F0b3JzOiBzdHJpbmdbXSA9IFtdXG4gICAgY29uc3QgZGV0ZWN0aW9uUnVsZXNUcmlnZ2VyZWQ6IHN0cmluZ1tdID0gW11cblxuICAgIC8vIENoZWNrIGlmIGZpbGUgaXMgdGV4dC1iYXNlZCBvciBiaW5hcnlcbiAgICBjb25zdCBpc1RleHRGaWxlID0gW1widHh0XCIsIFwibG9nXCIsIFwibWRcIiwgXCJqc29uXCIsIFwieG1sXCIsIFwiaHRtbFwiLCBcImNzc1wiLCBcImpzXCIsIFwicHlcIiwgXCJqYXZhXCIsIFwiY1wiLCBcImNwcFwiLCBcImhcIiwgXCJiYXRcIiwgXCJwczFcIiwgXCJzaFwiXS5pbmNsdWRlcyhmaWxlVHlwZSlcbiAgICBjb25zdCBpc0RvY3VtZW50RmlsZSA9IFtcImRvY1wiLCBcImRvY3hcIiwgXCJwZGZcIiwgXCJydGZcIl0uaW5jbHVkZXMoZmlsZVR5cGUpXG4gICAgXG4gICAgLy8gT25seSBwZXJmb3JtIHN0cmluZyBhbmFseXNpcyBvbiB0ZXh0LWJhc2VkIGZpbGVzIG9yIGlmIHdlIGNhbiBzYWZlbHkgY29udmVydCB0byBzdHJpbmdcbiAgICBpZiAoaXNUZXh0RmlsZSB8fCBpc0RvY3VtZW50RmlsZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZmlsZUNvbnRlbnQgPSBidWZmZXIudG9TdHJpbmcoXCJ1dGY4XCIpXG4gICAgICAgIFxuICAgICAgICAvLyBTdXNwaWNpb3VzIHN0cmluZ3NcbiAgICAgICAgY29uc3Qgc3VzcGljaW91c1N0cmluZ3MgPSBbXG4gICAgICAgICAgXCJwb3dlcnNoZWxsXCIsXG4gICAgICAgICAgXCJjbWQuZXhlXCIsXG4gICAgICAgICAgXCJiYXNlNjRcIixcbiAgICAgICAgICBcImV2YWxcIixcbiAgICAgICAgICBcImV4ZWNcIixcbiAgICAgICAgICBcInN5c3RlbVwiLFxuICAgICAgICAgIFwic2hlbGxcIixcbiAgICAgICAgICBcImRvd25sb2FkXCIsXG4gICAgICAgICAgXCJodHRwOi8vXCIsXG4gICAgICAgICAgXCJmdHA6Ly9cIixcbiAgICAgICAgICBcImJpdGNvaW5cIixcbiAgICAgICAgICBcImNyeXB0b1wiLFxuICAgICAgICAgIFwidGFza2tpbGxcIixcbiAgICAgICAgICBcInN5c3RlbTMyXCIsXG4gICAgICAgICAgXCJhZG1pblwiLFxuICAgICAgICAgIFwicmV2ZXJzZSBzaGVsbFwiLFxuICAgICAgICAgIFwibmMuZXhlXCIsXG4gICAgICAgICAgXCIvYmluL3NoXCIsXG4gICAgICAgICAgXCJiYXNoIC1pXCIsXG4gICAgICAgICAgXCJ3aG9hbWlcIixcbiAgICAgICAgICBcIm5ldCB1c2VyXCIsXG4gICAgICAgICAgXCJyZWcgYWRkXCIsXG4gICAgICAgICAgXCJyZWcgZGVsZXRlXCIsXG4gICAgICAgICAgXCJzY2h0YXNrc1wiLFxuICAgICAgICAgIFwiYXQuZXhlXCIsXG4gICAgICAgICAgXCJzYy5leGVcIixcbiAgICAgICAgICBcIndtaWNcIixcbiAgICAgICAgICBcInZzc2FkbWluXCIsXG4gICAgICAgICAgXCJieXBhc3NcIixcbiAgICAgICAgICBcImVuY29kZWRjb21tYW5kXCIsXG4gICAgICAgICAgXCItZW5jXCIsXG4gICAgICAgICAgXCJJbnZva2UtRXhwcmVzc2lvblwiLFxuICAgICAgICAgIFwiSW52b2tlLVdlYlJlcXVlc3RcIlxuICAgICAgICBdXG4gICAgICAgIFxuICAgICAgICBzdXNwaWNpb3VzU3RyaW5ncy5mb3JFYWNoKChzdHIpID0+IHtcbiAgICAgICAgICBpZiAoZmlsZUNvbnRlbnQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzdHIpKSB7XG4gICAgICAgICAgICBzdXNwaWNpb3VzSW5kaWNhdG9ycy5wdXNoKGBDb250YWlucyBzdXNwaWNpb3VzIHN0cmluZzogJHtzdHJ9YClcbiAgICAgICAgICAgIGRldGVjdGlvblJ1bGVzVHJpZ2dlcmVkLnB1c2goXCJTVVNQSUNJT1VTX1NUUklOR19ERVRFQ1RFRFwiKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICAvLyBTeXN0ZW0gZm9sZGVyL2FkbWluIHRvb2wgdXNhZ2VcbiAgICAgICAgaWYgKGZpbGVDb250ZW50LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJzeXN0ZW0zMlwiKSkge1xuICAgICAgICAgIHN1c3BpY2lvdXNJbmRpY2F0b3JzLnB1c2goXCJBY2Nlc3MgdG8gc3lzdGVtMzIgZm9sZGVyXCIpXG4gICAgICAgICAgZGV0ZWN0aW9uUnVsZXNUcmlnZ2VyZWQucHVzaChcIlNZU1RFTV9GT0xERVJfQUNDRVNTXCIpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpbGVDb250ZW50LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJ0YXNra2lsbFwiKSkge1xuICAgICAgICAgIHN1c3BpY2lvdXNJbmRpY2F0b3JzLnB1c2goXCJVc2VzICd0YXNra2lsbCcgY29tbWFuZFwiKVxuICAgICAgICAgIGRldGVjdGlvblJ1bGVzVHJpZ2dlcmVkLnB1c2goXCJBRE1JTl9UT09MX1VTQUdFXCIpXG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIkNvdWxkIG5vdCBhbmFseXplIGZpbGUgY29udGVudCBhcyB0ZXh0OlwiLCBlcnJvcilcbiAgICAgICAgLy8gQ29udGludWUgd2l0aCBvdGhlciBhbmFseXNpcyBtZXRob2RzXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIGVudHJvcHkgc2FmZWx5XG4gICAgbGV0IGVudHJvcHkgPSAwXG4gICAgdHJ5IHtcbiAgICAgIGVudHJvcHkgPSBjYWxjdWxhdGVFbnRyb3B5KGJ1ZmZlcilcbiAgICAgIGlmIChlbnRyb3B5ID4gNy41KSB7XG4gICAgICAgIHN1c3BpY2lvdXNJbmRpY2F0b3JzLnB1c2goXCJIaWdoIGZpbGUgZW50cm9weSAocG9zc2libGUgb2JmdXNjYXRpb24gb3IgcGFja2VkIGJpbmFyeSlcIilcbiAgICAgICAgZGV0ZWN0aW9uUnVsZXNUcmlnZ2VyZWQucHVzaChcIkhJR0hfRU5UUk9QWV9ERVRFQ1RFRFwiKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJDb3VsZCBub3QgY2FsY3VsYXRlIGVudHJvcHk6XCIsIGVycm9yKVxuICAgICAgLy8gQ29udGludWUgd2l0aG91dCBlbnRyb3B5IGFuYWx5c2lzXG4gICAgfVxuXG4gICAgLy8gVGhyZWF0IHNjb3JpbmdcbiAgICBsZXQgdGhyZWF0U2NvcmUgPSAwXG4gICAgaWYgKFtcImV4ZVwiLCBcImRsbFwiLCBcInNjclwiLCBcImJhdFwiLCBcImNtZFwiLCBcInBpZlwiLCBcImNvbVwiXS5pbmNsdWRlcyhmaWxlVHlwZSkpIHRocmVhdFNjb3JlICs9IDMwXG4gICAgaWYgKGZpbGUuc2l6ZSA8IDEwMjQpIHRocmVhdFNjb3JlICs9IDEwXG4gICAgaWYgKGZpbGUuc2l6ZSA+IDUwICogMTAyNCAqIDEwMjQpIHRocmVhdFNjb3JlICs9IDEwXG4gICAgdGhyZWF0U2NvcmUgKz0gc3VzcGljaW91c0luZGljYXRvcnMubGVuZ3RoICogMTBcbiAgICBpZiAoZW50cm9weSA+IDcuNSkgdGhyZWF0U2NvcmUgKz0gMTBcbiAgICBpZiAoZGV0ZWN0aW9uUnVsZXNUcmlnZ2VyZWQubGVuZ3RoID4gMCkgdGhyZWF0U2NvcmUgKz0gZGV0ZWN0aW9uUnVsZXNUcmlnZ2VyZWQubGVuZ3RoICogNVxuICAgIGlmICh0aHJlYXRTY29yZSA+IDEwMCkgdGhyZWF0U2NvcmUgPSAxMDBcblxuICAgIGxldCB0aHJlYXRMZXZlbDogXCJjbGVhblwiIHwgXCJzdXNwaWNpb3VzXCIgfCBcIm1hbGljaW91c1wiID0gXCJjbGVhblwiXG4gICAgaWYgKHRocmVhdFNjb3JlID49IDcwKSB0aHJlYXRMZXZlbCA9IFwibWFsaWNpb3VzXCJcbiAgICBlbHNlIGlmICh0aHJlYXRTY29yZSA+PSAzMCkgdGhyZWF0TGV2ZWwgPSBcInN1c3BpY2lvdXNcIlxuXG4gICAgLy8gUmVjb21tZW5kYXRpb25cbiAgICBsZXQgcmVjb21tZW5kYXRpb24gPSBcIk5vIG9idmlvdXMgdGhyZWF0cyBkZXRlY3RlZCBpbiB0aGUgZmlsZS4gSG93ZXZlciwgcHJvY2VlZCB3aXRoIGNhdXRpb24gaWYgeW91IGRvIG5vdCB0cnVzdCB0aGUgc291cmNlLlwiXG4gICAgaWYgKHRocmVhdExldmVsID09PSBcIm1hbGljaW91c1wiKSByZWNvbW1lbmRhdGlvbiA9IFwiRG8gbm90IHJ1biB0aGlzIGZpbGUuIEl0IGlzIGxpa2VseSBtYWx3YXJlLlwiXG4gICAgZWxzZSBpZiAodGhyZWF0TGV2ZWwgPT09IFwic3VzcGljaW91c1wiKSByZWNvbW1lbmRhdGlvbiA9IFwiRmlsZSBtYXkgYmUgc3VzcGljaW91cy4gQW5hbHl6ZSBmdXJ0aGVyIGJlZm9yZSBydW5uaW5nLlwiXG5cbiAgICAvLyBPcHRpb25hbDogRXh0ZXJuYWwgcmVwb3J0IGxpbmsgKG1vY2spXG4gICAgbGV0IGV4dGVybmFsUmVwb3J0TGluayA9IHVuZGVmaW5lZFxuICAgIGlmICh0aHJlYXRTY29yZSA+IDUwKSB7XG4gICAgICBleHRlcm5hbFJlcG9ydExpbmsgPSBgaHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vZ3VpL2ZpbGUvJHtoYXNofWBcbiAgICB9XG5cbiAgICAvLyBCdWlsZCByZXNwb25zZVxuICAgIGNvbnN0IHJlc3BvbnNlID0ge1xuICAgICAgZmlsZV9uYW1lOiBmaWxlLm5hbWUsXG4gICAgICBzaGEyNTY6IGhhc2gsXG4gICAgICBtZDU6IG1kNSxcbiAgICAgIGZpbGVfc2l6ZTogYCR7KGZpbGUuc2l6ZSAvIDEwMjQpLnRvRml4ZWQoMil9IEtCYCxcbiAgICAgIGZpbGVfdHlwZTogZmlsZVR5cGUsXG4gICAgICBtaW1lX3R5cGU6IG1pbWVUeXBlLFxuICAgICAgdXBsb2FkX3RpbWU6IHVwbG9hZFRpbWUsXG4gICAgICB0aHJlYXRfc2NvcmU6IHRocmVhdFNjb3JlLFxuICAgICAgdGhyZWF0X2xldmVsOiB0aHJlYXRMZXZlbCxcbiAgICAgIHN1c3BpY2lvdXNfaW5kaWNhdG9yczogc3VzcGljaW91c0luZGljYXRvcnMsXG4gICAgICBkZXRlY3Rpb25fcnVsZXNfdHJpZ2dlcmVkOiBkZXRlY3Rpb25SdWxlc1RyaWdnZXJlZCxcbiAgICAgIHJlY29tbWVuZGF0aW9uLFxuICAgICAgZXh0ZXJuYWxfcmVwb3J0X2xpbms6IGV4dGVybmFsUmVwb3J0TGluayxcbiAgICB9XG5cbiAgICAvLyBTdG9yZSB0aGUgcmVwb3J0IGZvciBsYXRlciByZXRyaWV2YWxcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVwb3J0RGF0YSA9IHtcbiAgICAgICAgLi4ucmVzcG9uc2UsXG4gICAgICAgIHNjYW5UaW1lOiB1cGxvYWRUaW1lLFxuICAgICAgICBpZDogaGFzaCxcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgc3RvcmVSZXBvcnQgfSA9IGF3YWl0IGltcG9ydChcIi4uL3JlcG9ydC91dGlsc1wiKVxuICAgICAgc3RvcmVSZXBvcnQoaGFzaCwgcmVwb3J0RGF0YSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKFwiQ291bGQgbm90IHN0b3JlIHJlcG9ydDpcIiwgZXJyb3IpXG4gICAgICAvLyBDb250aW51ZSB3aXRob3V0IHN0b3JpbmcgcmVwb3J0XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3BvbnNlKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJBbmFseXNpcyBlcnJvcjpcIiwgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiQW5hbHlzaXMgZmFpbGVkXCIgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3J5cHRvIiwiY2FsY3VsYXRlRW50cm9weSIsImJ1ZiIsImZyZXEiLCJBcnJheSIsImZpbGwiLCJpIiwibGVuZ3RoIiwiZW50cm9weSIsInAiLCJNYXRoIiwibG9nMiIsIlBPU1QiLCJyZXF1ZXN0IiwiZm9ybURhdGEiLCJmaWxlIiwiZ2V0IiwianNvbiIsImVycm9yIiwic3RhdHVzIiwibWF4U2l6ZSIsInNpemUiLCJieXRlcyIsImJ1ZmZlciIsImFycmF5QnVmZmVyIiwiQnVmZmVyIiwiZnJvbSIsImNvbnNvbGUiLCJoYXNoIiwiY3JlYXRlSGFzaCIsInVwZGF0ZSIsImRpZ2VzdCIsIm1kNSIsIm1pbWVUeXBlIiwidHlwZSIsImZpbGVUeXBlIiwiZXh0TWF0Y2giLCJuYW1lIiwibWF0Y2giLCJ0b0xvd2VyQ2FzZSIsInVwbG9hZFRpbWUiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzdXNwaWNpb3VzSW5kaWNhdG9ycyIsImRldGVjdGlvblJ1bGVzVHJpZ2dlcmVkIiwiaXNUZXh0RmlsZSIsImluY2x1ZGVzIiwiaXNEb2N1bWVudEZpbGUiLCJmaWxlQ29udGVudCIsInRvU3RyaW5nIiwic3VzcGljaW91c1N0cmluZ3MiLCJmb3JFYWNoIiwic3RyIiwicHVzaCIsIndhcm4iLCJ0aHJlYXRTY29yZSIsInRocmVhdExldmVsIiwicmVjb21tZW5kYXRpb24iLCJleHRlcm5hbFJlcG9ydExpbmsiLCJ1bmRlZmluZWQiLCJyZXNwb25zZSIsImZpbGVfbmFtZSIsInNoYTI1NiIsImZpbGVfc2l6ZSIsInRvRml4ZWQiLCJmaWxlX3R5cGUiLCJtaW1lX3R5cGUiLCJ1cGxvYWRfdGltZSIsInRocmVhdF9zY29yZSIsInRocmVhdF9sZXZlbCIsInN1c3BpY2lvdXNfaW5kaWNhdG9ycyIsImRldGVjdGlvbl9ydWxlc190cmlnZ2VyZWQiLCJleHRlcm5hbF9yZXBvcnRfbGluayIsInJlcG9ydERhdGEiLCJzY2FuVGltZSIsImlkIiwic3RvcmVSZXBvcnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/analyze/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5Chp%5CDocuments%5CThreatScan%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Chp%5CDocuments%5CThreatScan&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();